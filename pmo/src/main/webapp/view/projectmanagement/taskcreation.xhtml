<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

<h:outputScript name="plugins/managerow/managerow.js" />

<h:body>

	<ui:composition template="/view/template/templatewithoutjquery.xhtml">
		<ui:define name="title">Création des tâches</ui:define>

		<ui:define name="body">

			<!-- Content Wrapper. Contains page content -->
			<div class="content-wrapper">
				<!-- Content Header (Page header) -->
				<section class="content-header" style="margin-left:-230px">
				<h1>Création des tâches</h1>
				<ol class="breadcrumb">
					<li><a href="./user/home"><i class="fa fa-dashboard"></i>
							Home</a></li>
					<li class="active">Création des tâches</li>
				</ol>
				</section>

				<!-- Main content -->
				<section class="content" style="margin-left:-230px"> <!-- Small boxes (Stat box) -->
				<!-- Main row -->
				
				<p:tabView value="#{projectController.projects}" var="project"
									scrollable="true" 
									styleClass="text-family" id="tabViewProject"
									dynamic="false">
				<p:tab title="Projet - #{project.name}">
						<div class="row">
							<!-- right col -->
							<section class="col-lg-7 connectedSortable">
								<div class="box">
									<div class="box-header">
										<h3 class="box-title">
											<i class="fa fa-th"> </i> Tâches
										</h3>
									</div>
									<div class="box-body">
										<div class="input-group margin">
					
					
											<h:form>
												<p:dataTable value="#{project.projectTasks}" var="projectTask" widgetVar="50"
													styleClass="table table-bordered text-family" editable="true">
													<p:ajax event="rowEdit"
														listener="#{projectController.onEditProjectTask}" />
													<p:ajax event="rowEditCancel"
														listener="#{projectController.onCancelProjectTask}" />
					
													<p:column>
														<f:facet name="header">
															<h:outputText value="Nom" />
														</f:facet>
														<p:cellEditor>
															<f:facet name="output">
																<h:outputText value="#{projectTask.name}" />
															</f:facet>
															<f:facet name="input">
																<h:inputText
																	styleClass="form-control #{component.valid ? '' : 'has-error'}"
																	value="#{projectTask.name}" required="true" name="name0"
																	placeholder='Nom'>
																	<f:validateLength minimum="2" maximum="50" />
																</h:inputText>
															</f:facet>
														</p:cellEditor>
													</p:column>
					
													<p:column>
														<f:facet name="header">
															<h:outputText value="Coût" />
														</f:facet>
														<p:cellEditor>
															<f:facet name="output">
																<h:outputText value="#{projectTask.cost}" />
															</f:facet>
															<f:facet name="input">
																<h:inputText
																	styleClass="form-control #{component.valid ? '' : 'has-error'}"
																	value="#{projectTask.cost}" required="true" name="cost0"
																	placeholder="Coût">
																	<f:validateRegex pattern="[0-9]+" />
																</h:inputText>
															</f:facet>
														</p:cellEditor>
													</p:column>
					
													<p:column headerText="Options">
														<p:rowEditor />
													</p:column>
					
												</p:dataTable>
					
												<p:panelGrid columns="2" styleClass="text-family">
													<h:outputLabel for="taskname" value="Nom de la tâche: " />
													<p:inputText id="taskname"
														value="#{taskController.projectTask.name}" required="true"/>
													<h:outputLabel for="taskcost" value="Coût: " />
													<p:inputText id="taskcost"
														value="#{taskController.projectTask.cost}" required="true"/>
													<f:facet name="footer">
														<p:commandButton id="addButtonProjectTask"
															value="Ajouter la tâche"
															actionListener="#{taskController.addProjectTask(project)}"
															update="tabViewProject" />
													</f:facet>
												</p:panelGrid>
											</h:form>
					
					
										</div>
									</div>
								</div>
							</section>
						</div>
						<!-- /.row -->

				</p:tab>
				</p:tabView>
				</section>

			</div>
			<!-- /.content-wrapper -->

		</ui:define>
	</ui:composition>

</h:body>
</html>