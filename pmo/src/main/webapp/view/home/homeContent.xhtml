<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:body>
	<ui:composition template="/view/template/template.xhtml">
		<ui:define name="title">Home</ui:define>
	
		<ui:define name="body">
			
			<h:panelGroup rendered="#{not empty facesContext.messageList}">
				<div class="alert alert-success alert-dismissible">
					<h:messages  globalOnly="true"  />
				</div>
			</h:panelGroup>
		
			<!-- Content Header (Page header) -->
			<section class="content-header">
				<h1>
					Dashboard <small>Panneau de contrôle</small>
				</h1>
				<ol class="breadcrumb">
					<li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
					<li class="active">Dashboard</li>
				</ol>
			</section>

			<!-- Main content -->
			<section class="content">
				<!-- Small boxes (Stat box) -->
				<div class="row">
					<div class="col-lg-3 col-xs-6">
						<!-- small box -->
						<div class="small-box bg-aqua">
							<div class="inner">
								<h3>150</h3>

								<p>Jours-hommes</p>
							</div>
							<div class="icon">
								<i class="ion ion-person-add"></i>
							</div>
							<a href="#" class="small-box-footer">More info <i
								class="fa fa-arrow-circle-right"></i></a>
						</div>
					</div>
					<!-- ./col -->
				</div>
				<!-- /.row -->

				<div class="row">
					<div class="col-xs-12">
					<div class="box">
						<div class="box-header">
							<h3 class="box-title">Planning des absences</h3>
							<div>
								<h:link outcome="user/event">
									<span>Ajouter une absence</span>
								</h:link>
							</div>
							<div class="box-tools">
								<div class="input-group input-group-sm" style="width: 150px;">
									<input type="text" name="table_search"
										class="form-control pull-right" placeholder="Search"/>
									<div class="input-group-btn">
										<button type="submit" class="btn btn-default">
											<i class="fa fa-search"></i>
										</button>
									</div>
								</div>
							</div>
						</div>
						<!-- /.box-header -->
						<div class="box-body table-responsive no-padding">
							<h:dataTable value="#{userController.absences}" var="absence"
								styleClass="table table-hover">

								<h:column>
									<!-- column header -->
									<f:facet name="header">Nom</f:facet>
									<!-- row record -->
    								#{absence.employee.lastname}
    							</h:column>

								<h:column>
									<!-- column header -->
									<f:facet name="header">Prénom</f:facet>
									<!-- row record -->
    								#{absence.employee.firstname}
    							</h:column>

								<h:column>
									<!-- column header -->
									<f:facet name="header">Date de début</f:facet>
									<!-- row record -->
    								#{absence.start}
    							</h:column>

								<h:column>
									<!-- column header -->
									<f:facet name="header">Date de fin</f:facet>
									<!-- row record -->
    								#{absence.end}
    							</h:column>

								<h:column>
									<!-- column header -->
									<f:facet name="header">Type</f:facet>
									<!-- row record -->
    								#{absence.type}
    							</h:column>

								<h:column>
									<!-- column header -->
									<f:facet name="header">Raison</f:facet>
									<!-- row record -->
    								#{absence.reason}
    							</h:column>

							</h:dataTable>
						</div>
						<!-- /.box-body -->
					</div>
					<!-- /.box -->
					</div>
				</div>

				<!-- Main row -->
				<div class="row">
					<!-- Left col -->
					<section class="col-lg-7 connectedSortable"></section>
					<!-- /.Left col -->
					<!-- right col -->
					<section class="col-lg-5 connectedSortable">
						<div class="box">
							<div class="box-header">
								<h3 class="box-title">Tâches en cours</h3>

								<div class="box-tools">
									<ul class="pagination pagination-sm no-margin pull-right">
										<li><a href="#">&laquo;</a></li>
										<li><a href="#">1</a></li>
										<li><a href="#">2</a></li>
										<li><a href="#">3</a></li>
										<li><a href="#">&raquo;</a></li>
									</ul>
								</div>
							</div>
							<!-- /.box-header -->
							<div class="box-body no-padding">
								<h:dataTable value="#{userController.tasks}" var="task"
									styleClass="table">

									<h:column>
										<!-- column header -->
										<f:facet name="header">Tâche</f:facet>
										<!-- row record -->
	    								#{task.id}
	    							</h:column>

									<h:column>
										<!-- column header -->
										<f:facet name="header">Tâche</f:facet>
										<!-- row record -->
	    								#{task.projectTask.name}
	    							</h:column>

									<h:column>
										<!-- column header -->
										<f:facet name="header">Responsable</f:facet>
										<!-- row record -->
	    								#{task.employee.lastname} #{task.employee.firstname}
	    							</h:column>

									<h:column>
										<!-- column header -->
										<f:facet name="header">Progression</f:facet>
										<!-- row record -->
										<div class="progress progress-xs">
											<div class="progress-bar progress-bar-danger"
												style="width: #{taskController.calculateProgression(task)}%"></div>
										</div>
									</h:column>

									<h:column>
										<!-- column header -->
										<f:facet name="header"></f:facet>
										<!-- row record -->
										<span class="badge bg-red">#{taskController.calculateProgression(task)}</span>
									</h:column>
								</h:dataTable>
							</div>
							<!-- /.box-body -->
						</div>
						<!-- /.box -->

					</section>
					<!-- right col -->
				</div>
				<!-- /.row (main row) -->

			</section>
			<!-- /.content -->
		</ui:define>
</ui:composition>

</h:body>
</html>