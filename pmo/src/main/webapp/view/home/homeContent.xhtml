<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	  xmlns:p="http://primefaces.org/ui">

<h:body>
	<ui:composition template="/view/template/templatewithoutjquery.xhtml">
		<ui:define name="title">Home</ui:define>
	
		<ui:define name="body">
			
			<h:panelGroup rendered="#{not empty facesContext.messageList}">
				<div class="alert alert-success alert-dismissible">
					<h:messages  globalOnly="true"  />
				</div>
			</h:panelGroup>
		
			<!-- Content Header (Page header) -->
			<section class="content-header">
				<h1>
					Dashboard <small>Panneau de contrôle</small>
				</h1>
				<ol class="breadcrumb">
					<li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
					<li class="active">Dashboard</li>
				</ol>
			</section>

			<!-- Main content -->
			<section class="content">
				<!-- Small boxes (Stat box) -->

				<div class="row">
					<!-- Left col -->
					<section class="col-lg-7 connectedSortable">
					<!-- /.Left col -->
					<div class="box">
						<div class="box-header"> 
							<h3 class="box-title">Planning des absences</h3>
							<div class="box-tools">
								<div class="input-group input-group-sm" style="width: 150px;">
									<input type="text" name="table_search"
										class="form-control pull-right" placeholder="Search"/>
									<div class="input-group-btn">
										<button type="submit" class="btn btn-default">
											<i class="fa fa-search"></i>
										</button>
									</div>
								</div>
							</div>
						</div>
						<!-- /.box-header -->
						<div class="box-body table-responsive no-padding">
							<!-- FIXME USERCONTROLLER : Voir fixme UserController : la méthode getAbsencesemployees n'est pas appelée  -->
							<h:dataTable value="#{userController.absencesEmployees}" var="absence"
								styleClass="table table-hover">

								<h:column>
									<!-- column header -->
									<f:facet name="header">Nom</f:facet>
									<!-- row record -->
    								#{absence.employee.lastname}
    							</h:column>

								<h:column>
									<!-- column header -->
									<f:facet name="header">Prénom</f:facet>
									<!-- row record -->
    								#{absence.employee.firstname}
    							</h:column>

								<h:column>
									<!-- column header -->
									<f:facet name="header">Date de début</f:facet>
									<!-- row record -->
    								#{absence.start}
    							</h:column>

								<h:column>
									<!-- column header -->
									<f:facet name="header">Date de fin</f:facet>
									<!-- row record -->
    								#{absence.end}
    							</h:column>

								<h:column>
									<!-- column header -->
									<f:facet name="header">Type</f:facet>
									<!-- row record -->
    								#{absence.type}
    							</h:column>

								<h:column>
									<!-- column header -->
									<f:facet name="header">Raison</f:facet>
									<!-- row record -->
    								#{absence.reason}
    							</h:column>

							</h:dataTable>
						</div>
						<!-- /.box-body -->
					</div>
					<!-- /.box -->
					</section>
					
					<!-- right col -->
					<section class="col-lg-5 connectedSortable">
						<div class="box">
							<div class="box-header">
								<h3 class="box-title">Mes tâches en cours</h3>
							</div>
							<!-- /.box-header -->
							<div class="box-body no-padding">
								<h:dataTable value="#{userController.tasks}" var="task"
									styleClass="table">

									<h:column>
										<!-- column header -->
										<f:facet name="header">Tâche</f:facet>
										<!-- row record -->
	    								#{task.id}
	    							</h:column>

									<h:column>
										<!-- column header -->
										<f:facet name="header">Tâche</f:facet>
										<!-- row record -->
	    								#{task.projectTask.name}
	    							</h:column>

									<h:column>
										<!-- column header -->
										<f:facet name="header">Responsable</f:facet>
										<!-- row record -->
	    								#{task.employee.lastname} #{task.employee.firstname}
	    							</h:column>
	    							
	    							<h:column>
										<!-- column header -->
										<f:facet name="header">Coût (JH) utilisé</f:facet>
										<!-- row record -->
	    								#{task.mandayUsed}
	    							</h:column>

									<h:column>
										<!-- column header -->
										<f:facet name="header">Progression</f:facet>
										<!-- row record -->
										<div class="progress progress-xs">
											<div class="progress-bar progress-bar-danger"
												style="width: #{taskController.calculateProgression(task)}%"></div>
										</div>
									</h:column>

									<h:column>
										<!-- column header -->
										<f:facet name="header"></f:facet>
										<!-- row record -->
										<span class="badge bg-red">#{taskController.calculateProgression(task)} %</span>
									</h:column>
								</h:dataTable>
							</div>
							<!-- /.box-body -->
						</div>
						<!-- /.box -->

					</section>
					<!-- right col -->
				</div>
				
				<div class="row">
					<section class="col-lg-7 connectedSortable">
						<div class="box">
								<div class="box-header">
									<h3 class="box-title">Etat des coûts des projets (Coût estimé, affecté et effectué)</h3>
								</div>
								<div class="box-body no-padding">
									<p:chart type="bar" model="#{taskController.barModel}" style="height:200px"/>
								</div>
							<!-- /.box-body -->
						</div>
					</section>
					
										<!-- right col -->
					<section class="col-lg-5 connectedSortable">
						<div class="box">
							<div class="box-header">
								<h3 class="box-title">Les tâches du projets</h3>
							</div>
							<!-- /.box-header -->
							<div class="box-body no-padding">
								<h:dataTable value="#{userController.allTasksEmployees}" var="task"
									styleClass="table">

									<h:column>
										<!-- column header -->
										<f:facet name="header">Tâche</f:facet>
										<!-- row record -->
	    								#{task.id}
	    							</h:column>

									<h:column>
										<!-- column header -->
										<f:facet name="header">Tâche</f:facet>
										<!-- row record -->
	    								#{task.projectTask.name}
	    							</h:column>

									<h:column>
										<!-- column header -->
										<f:facet name="header">Responsable</f:facet>
										<!-- row record -->
	    								#{task.employee.lastname} #{task.employee.firstname}
	    							</h:column>
	    							
	    							<h:column>
										<!-- column header -->
										<f:facet name="header">Coût (JH) utilisé</f:facet>
										<!-- row record -->
	    								#{task.mandayUsed}
	    							</h:column>

									<h:column>
										<!-- column header -->
										<f:facet name="header">Progression</f:facet>
										<!-- row record -->
										<div class="progress progress-xs">
											<div class="progress-bar progress-bar-danger"
												style="width: #{taskController.calculateProgression(task)}%"></div>
										</div>
									</h:column>

									<h:column>
										<!-- column header -->
										<f:facet name="header"></f:facet>
										<!-- row record -->
										<span class="badge bg-red">#{taskController.calculateProgression(task)} %</span>
									</h:column>
								</h:dataTable>
							</div>
							<!-- /.box-body -->
						</div>
						<!-- /.box -->

					</section>
					<!-- right col -->
				</div>

				<!-- Main row -->
				<div class="row">
					
				</div>
				<!-- /.row (main row) -->

			</section>
			<!-- /.content -->
		</ui:define>
</ui:composition>

</h:body>
</html>